# Arduino on XIAO RP2350

## Overview

The SeeedStudio XIAO RP2350 features the Raspberry Pi RP2350 dual-core ARM Cortex-M33 processor.

## Board Manager Setup

1. Open Arduino IDE
2. File > Preferences > Additional Boards Manager URLs
3. Add: `https://github.com/earlephilhower/arduino-pico/releases/download/global/package_rp2350_index.json`
4. Tools > Board > Boards Manager > Search "Raspberry Pi Pico" > Install
5. Tools > Board > Raspberry Pi RP2350 > Select "XIAO RP2350"

## First Sketch

```cpp
void setup() {
    Serial.begin(115200);
    pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
    Serial.println("Hello XIAO RP2350!");
    digitalWrite(LED_BUILTIN, HIGH);
    delay(1000);
    digitalWrite(LED_BUILTIN, LOW);
    delay(1000);
}
```

## Pin Mapping

| Name | GPIO | Functions | Notes |
|------|------|-----------|-------|
| D0 | GPIO26 | A0, ADC | Analog input |
| D1 | GPIO27 | A1, ADC | Analog input |
| D2 | GPIO28 | A2, ADC | Analog input |
| D3 | GPIO29 | A3, ADC | Analog input |
| D4 | GPIO4 | GPIO | - |
| D5 | GPIO3 | SPI0_CSn | - |
| D6 | GPIO2 | PWM, SDA1 | - |
| D7 | GPIO5 | PWM, SCL1 | - |
| D8 | GPIO8 | SPI1_CSn | - |
| D9 | GPIO9 | SPI1_SCK | - |
| D10 | GPIO7 | SPI1_MOSI | - |
| D11 | GPIO6 | SPI1_MISO | - |
| D12 | GPIO13 | - | - |
| D13 | GPIO14 | SDA0 | I2C0 SDA |
| D14 | GPIO15 | SCL0 | I2C0 SCL |
| D15 | GPIO16 | - | - |
| D16 | GPIO17 | TX1 | UART1 TX |
| D17 | GPIO18 | RX1 | UART1 RX |
| D18 | GPIO19 | - | - |
| D19 | GPIO20 | - | - |
| D20 | GPIO21 | TX1 | - |
| D21 | GPIO22 | RX1 | - |
| D22 | GPIO23 | - | - |
| D23 | GPIO24 | - | - |
| D6 | GPIO0 | TX0 | UART0 TX |
| D7 | GPIO1 | RX0 | UART0 RX |
| D8 | GPIO2 | SCK0 | SPI0 SCK |
| D10 | GPIO3 | MOSI0 | SPI0 MOSI |
| D9 | GPIO4 | MISO0 | SPI0 MISO |

Built-in LED: GPIO25 (green, on XIAO)

## Special Features

### Dual Core ARM Cortex-M33

```cpp
// RP2350 has two ARM Cortex-M33 cores
// Both can run Arduino code

void setup() {
    Serial.begin(115200);
    Serial.printf("Core: %d\n", get_core_num());
}

void loop() {
    Serial.printf("Running on core %d\n", get_core_num());
    delay(1000);
}
```

### PIO (Programmable I/O)

```cpp
#include <hardware/pio.h>
#include <hardware/dma.h>

// PIO programs same as RP2040
// See RP2040 PIO documentation
```

### ARM Cortex-M33 Features

```cpp
// ARMv8-M architecture
// TrustZone-M support
// DSP extensions
// Floating point (optional)

void setup() {
    Serial.begin(115200);

    // Check CPU features
    Serial.printf("CPU ID: 0x%08lX\n", scb_cpu_id);
    Serial.printf("Core count: %d\n', 2);
}

void loop() {}
```

## ADC (12-bit)

```cpp
void setup() {
    Serial.begin(115200);
    analogReadResolution(12);
}

void loop() {
    int adc = analogRead(A0);
    float voltage = adc * 3.3 / 4095;
    Serial.printf("ADC: %d, Voltage: %.2fV\n", adc, voltage);
    delay(1000);
}
```

## PWM

```cpp
void setup() {
    Serial.begin(115200);
}

void loop() {
    // PWM on GPIO2
    analogWrite(2, 128);  // 50% duty
    delay(1000);
}
```

## I2C

```cpp
#include <Wire.h>

void setup() {
    Wire.setSDA(13);
    Wire.setSCL(14);
    Wire.begin();
}

void loop() {
    Wire.beginTransmission(0x76);
    Wire.write(0x00);
    Wire.endTransmission();
}
```

## SPI

```cpp
#include <SPI.h>

#define SPI_CS 5

void setup() {
    SPI.setSCK(2);
    SPI.setTX(3);
    SPI.setRX(4);
    SPI.begin();
    pinMode(SPI_CS, OUTPUT);
}

void loop() {
    digitalWrite(SPI_CS, LOW);
    byte data = SPI.transfer(0x00);
    digitalWrite(SPI_CS, HIGH);
}
```

## UART

```cpp
// UART0 (USB Serial)
Serial.begin(115200);

// UART1 (Hardware)
Serial1.setTX(17);
Serial1.setRX(18);
Serial1.begin(9600);
```

## Boot Selection

```cpp
// RP2350 supports boot from QSPI flash or RAM
// Select boot mode in IDE: Tools > Boot Mode

// Options:
// - QSPI (default)
// - RAM (for development)
```

## Key Differences from RP2040

| Feature | RP2040 | RP2350 |
|---------|--------|--------|
| Core | Cortex-M0+ @ 133MHz | Cortex-M33 @ 150MHz |
| Cores | 2 | 2 |
| Flash | External QSPI | External QSPI |
| RAM | 264 KB | 520 KB |
| PIO | 2 x PIO | 2 x PIO |
| ADC | 12-bit, 4 ch | 12-bit, 4 ch |
| Arm Architecture | ARMv6-M | ARMv8-M |
| DSP | No | Yes |
| TrustZone | No | Yes |
| Floating Point | No | Optional |

## Key Specifications

| Feature | Value |
|---------|-------|
| MCU | RP2350 |
| Core | Dual ARM Cortex-M33 @ 150MHz |
| Flash | External QSPI |
| RAM | 520 KB |
| GPIO | 30 pins |
| ADC | 12-bit, 4 channels |
| PWM | 16 channels |
| PIO | 2 blocks |
| I2C | 2 |
| SPI | 2 |
| UART | 2 + USB |

## Known Issues

1. **New platform**: Less mature than RP2040
2. **Boot mode**: Select correct boot mode
3. **Power**: Needs stable 3.3V supply
4. **PIO**: Programs may need adjustment

## Troubleshooting

### Can't upload

1. Hold BOOTSEL while connecting USB
2. Check for RPI-RP2 drive
3. Copy .uf2 file

### Code doesn't run

1. Check boot mode setting
2. Verify correct board selected
3. Check for compile errors

### GPIO wrong

1. Verify pin mapping
2. Check GPIO initialization
3. Ensure correct function selected

## Best Practices

1. **Power**: Use stable 3.3V supply
2. **Decoupling**: Add 100nF capacitors
3. **Signals**: Keep traces short
4. **Boot**: Use QSPI for production
5. **Dual Core**: Use both cores for performance

## Performance Tips

1. **Dual Core**: Use both cores
2. **DMA**: Use for data transfer
3. **PIO**: Offload protocols
4. **Cache**: Enable cache
5. **Optimize**: Use -O3 flag
