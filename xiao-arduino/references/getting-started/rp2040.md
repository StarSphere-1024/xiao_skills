# XIAO RP2040 Arduino Getting Started

## Board Manager Setup

1. Open Arduino IDE 2.x
2. Add to "Additional Boards Manager URLs":
   ```cpp
   https://github.com/earlephilhower/arduino-pico/releases/download/global/package_rp2040_index.json
   ```
3. Install "Raspberry Pi Pico/RP2040" by Earle Philhower
4. Select: **Tools > Board > Raspberry Pi Pico**

## Bootloader Mode

1. Hold **BOOTSEL** button
2. Connect USB (or press RESET while holding BOOTSEL)
3. RPI-RP2 drive appears
4. Copy `.uf2` file to the drive

## Pin Mapping

| Pin | GPIO | Arduino | Function | Notes |
|-----|------|---------|----------|-------|
| D0 | GPIO26 | D0 | ADC | Analog input |
| D1 | GPIO27 | D1 | ADC | Analog input |
| D2 | GPIO28 | D2 | ADC | Analog input |
| D3 | GPIO29 | D3 | ADC | Analog input |
| D4 | GPIO6 | D4 | I2C SDA | Default I2C SDA (XIAO standard) |
| D5 | GPIO7 | D5 | I2C SCL | Default I2C SCL (XIAO standard) |
| D6 | GPIO0 | D6 | UART TX | Default UART TX (XIAO standard) |
| D7 | GPIO1 | D7 | UART RX / CSn | Default UART RX; can be used as SPI CS |
| D8 | GPIO2 | D8 | SPI SCK | Default SPI SCK (XIAO standard) |
| D9 | GPIO4 | D9 | SPI MISO | Default SPI MISO (XIAO standard) |
| D10 | GPIO3 | D10 | SPI MOSI | Default SPI MOSI (XIAO standard) |

## I2C

```cpp
#include <Wire.h>

void setup() {
    Wire.begin();
}

void loop() {}
```

## SPI

```cpp
#include <SPI.h>

void setup() {
    SPI.begin();  // Uses D8 (SCK), D9 (MISO), D10 (MOSI) by default
}

void loop() {
    byte data = SPI.transfer(0x00);
}
```

## UART

```cpp
// Serial0 (USB)
Serial.begin(115200);

// Serial1 (on pins)
Serial1.begin(115200, SERIAL_8N1, 7, 6);  // RX=D7, TX=D6
```

## First Sketch

```cpp
void setup() {
    Serial.begin(115200);
    pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
    Serial.println("Hello XIAO RP2040!");
    // Note: on XIAO RP2040 the built-in RGB LED pins are typically active-low.
    digitalWrite(LED_BUILTIN, LOW);
    delay(200);
    digitalWrite(LED_BUILTIN, HIGH);
    delay(1000);
}
```

## PWM

```cpp
const int pwmPin = D10;

void setup() {
    analogWriteFreq(1000);    // 1kHz
    analogWriteRange(255);    // 8-bit
    analogWrite(pwmPin, 128);  // 50% duty
}
```

## ADC

```cpp
const int adcPin = A0;

void setup() {
    analogReadResolution(12);  // 12-bit (0-4095)
}

void loop() {
    int value = analogRead(adcPin);
    float voltage = value * 3.3 / 4095.0;
    Serial.println(voltage);
    delay(1000);
}
```

## Multiple I2C

```cpp
#include <Wire.h>

TwoWire I2C0 = TwoWire(0);
TwoWire I2C1 = TwoWire(1);

void setup() {
    I2C0.setSDA(0);
    I2C0.setSCL(1);
    I2C0.begin();

    I2C1.setSDA(2);
    I2C1.setSCL(3);
    I2C1.begin();
}
```

## Watchdog Timer

```cpp
#include "hardware/watchdog.h"

void setup() {
    Serial.begin(115200);
    watchdog_enable(4000);  // 4 second timeout
}

void loop() {
    watchdog_update();
    delay(1000);
}
```

## Boot Button

```cpp
// Enter BOOTSEL (UF2) mode by holding the BOOT button while plugging in USB.
```

## Troubleshooting

### Can't upload

1. Hold BOOTSEL while connecting USB
2. Check RPI-RP2 drive appears
3. Copy .uf2 file

### Wrong pin numbers

XIAO RP2040 uses different pin mapping than Raspberry Pi Pico. Use D0-D10 labels.

### I2C not working

Use the XIAO-standard I2C pins: D4 (GPIO6) and D5 (GPIO7).
